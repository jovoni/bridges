<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Create comprehensive heatmap with optional phylogenetic tree — plot_heatmap • bridges</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Create comprehensive heatmap with optional phylogenetic tree — plot_heatmap"><meta name="description" content="This function creates a heatmap visualization with optional phylogenetic
tree display, annotations, and support for multiple features. It can display
genomic data across chromosomes with customizable tree coloring based on
reconstruction data."><meta property="og:description" content="This function creates a heatmap visualization with optional phylogenetic
tree display, annotations, and support for multiple features. It can display
genomic data across chromosomes with customizable tree coloring based on
reconstruction data."></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">bridges</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.0.0.9000</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="nav-item"><a class="nav-link" href="../articles/bridges.html">Get started</a></li>
<li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Create comprehensive heatmap with optional phylogenetic tree</h1>

      <div class="d-none name"><code>plot_heatmap.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>This function creates a heatmap visualization with optional phylogenetic
tree display, annotations, and support for multiple features. It can display
genomic data across chromosomes with customizable tree coloring based on
reconstruction data.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">plot_heatmap</span><span class="op">(</span></span>
<span>  <span class="va">data</span>,</span>
<span>  tree <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  chromosomes_to_plot <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">22</span>, <span class="st">"X"</span>, <span class="st">"Y"</span><span class="op">)</span>,</span>
<span>  to_plot <span class="op">=</span> <span class="st">"CN"</span>,</span>
<span>  tree_width <span class="op">=</span> <span class="fl">3.5</span>,</span>
<span>  show_tree <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  branch_length <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  annotations <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  ladderize <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  reorder_tree <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  distance_matrix <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  use_raster <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  raster_quality <span class="op">=</span> <span class="fl">10</span>,</span>
<span>  reconstruction <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  chr_for_coloring <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  allele_for_coloring <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  tree_colors <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"black"</span>, <span class="st">"goldenrod"</span><span class="op">)</span>,</span>
<span>  node_size <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  tip_size <span class="op">=</span> <span class="fl">0</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-data">data<a class="anchor" aria-label="anchor" href="#arg-data"></a></dt>
<dd><p>Data frame containing cell_id, chr, start, and feature columns.
Must include the columns specified in <code>to_plot</code> parameter.</p></dd>


<dt id="arg-tree">tree<a class="anchor" aria-label="anchor" href="#arg-tree"></a></dt>
<dd><p>Phylogenetic tree object (optional). Should be compatible with
ape or phylo class objects.</p></dd>


<dt id="arg-chromosomes-to-plot">chromosomes_to_plot<a class="anchor" aria-label="anchor" href="#arg-chromosomes-to-plot"></a></dt>
<dd><p>Vector of chromosomes to include in the plot.
Default: c(1:22, "X", "Y") for human chromosomes.</p></dd>


<dt id="arg-to-plot">to_plot<a class="anchor" aria-label="anchor" href="#arg-to-plot"></a></dt>
<dd><p>Vector of feature names to plot. Default: "CN" (copy number).
Must correspond to column names in the data.</p></dd>


<dt id="arg-tree-width">tree_width<a class="anchor" aria-label="anchor" href="#arg-tree-width"></a></dt>
<dd><p>Width of tree display in centimeters. Default: 3.5.</p></dd>


<dt id="arg-show-tree">show_tree<a class="anchor" aria-label="anchor" href="#arg-show-tree"></a></dt>
<dd><p>Logical indicating whether to display the phylogenetic tree.
Default: TRUE.</p></dd>


<dt id="arg-branch-length">branch_length<a class="anchor" aria-label="anchor" href="#arg-branch-length"></a></dt>
<dd><p>Numeric value for uniform branch length transformation
of the tree. If NULL (default), original branch lengths are preserved.</p></dd>


<dt id="arg-annotations">annotations<a class="anchor" aria-label="anchor" href="#arg-annotations"></a></dt>
<dd><p>Data frame with cell_id column and additional annotation
columns. Each non-cell_id column becomes a row annotation in the heatmap.
Optional parameter.</p></dd>


<dt id="arg-ladderize">ladderize<a class="anchor" aria-label="anchor" href="#arg-ladderize"></a></dt>
<dd><p>Logical indicating whether to ladderize (sort) the tree
branches. Default: FALSE.</p></dd>


<dt id="arg-reorder-tree">reorder_tree<a class="anchor" aria-label="anchor" href="#arg-reorder-tree"></a></dt>
<dd><p>Logical indicating whether to optimize tree tip ordering
for better visualization. Default: TRUE.</p></dd>


<dt id="arg-distance-matrix">distance_matrix<a class="anchor" aria-label="anchor" href="#arg-distance-matrix"></a></dt>
<dd><p>Distance matrix for tree reordering optimization.
Optional parameter used when reorder_tree is TRUE.</p></dd>


<dt id="arg-use-raster">use_raster<a class="anchor" aria-label="anchor" href="#arg-use-raster"></a></dt>
<dd><p>Logical indicating whether to use raster graphics for
the heatmap. Default: TRUE for better performance with large datasets.</p></dd>


<dt id="arg-raster-quality">raster_quality<a class="anchor" aria-label="anchor" href="#arg-raster-quality"></a></dt>
<dd><p>Numeric value controlling raster image quality.
Higher values produce better quality. Default: 10.</p></dd>


<dt id="arg-reconstruction">reconstruction<a class="anchor" aria-label="anchor" href="#arg-reconstruction"></a></dt>
<dd><p>Reconstruction data for coloring tree branches based
on ancestral state reconstruction. Optional parameter.</p></dd>


<dt id="arg-chr-for-coloring">chr_for_coloring<a class="anchor" aria-label="anchor" href="#arg-chr-for-coloring"></a></dt>
<dd><p>Chromosome identifier used for tree branch coloring
when reconstruction data is provided. Optional parameter.</p></dd>


<dt id="arg-allele-for-coloring">allele_for_coloring<a class="anchor" aria-label="anchor" href="#arg-allele-for-coloring"></a></dt>
<dd><p>Specific allele used for tree branch coloring
when reconstruction data is provided. Optional parameter.</p></dd>


<dt id="arg-tree-colors">tree_colors<a class="anchor" aria-label="anchor" href="#arg-tree-colors"></a></dt>
<dd><p>Vector of colors for tree branch coloring. Default:
c("black", "goldenrod"). First color for one state, second for another.</p></dd>


<dt id="arg-node-size">node_size<a class="anchor" aria-label="anchor" href="#arg-node-size"></a></dt>
<dd><p>Size of internal nodes in the tree. Default: 1.</p></dd>


<dt id="arg-tip-size">tip_size<a class="anchor" aria-label="anchor" href="#arg-tip-size"></a></dt>
<dd><p>Size of tip nodes in the tree visualization. Default: 0
(tips not displayed).</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>A ComplexHeatmap object that can be displayed or further customized.
The object contains the combined heatmap(s) and optional tree annotation.</p>
    </div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>The function performs the following main steps:</p><ul><li><p>Validates input parameters and data structure</p></li>
<li><p>Processes the phylogenetic tree (if provided) with optional coloring</p></li>
<li><p>Prepares row annotations from the annotations data frame</p></li>
<li><p>Creates individual heatmaps for each feature in to_plot</p></li>
<li><p>Combines multiple heatmaps horizontally</p></li>
<li><p>Adds tree annotation to the left side (if requested)</p></li>
</ul><p>The tree can be colored based on reconstruction data, which is useful for
visualizing ancestral state reconstructions or other phylogenetic analyses.
When reconstruction data is provided, the tree branches are colored according
to the specified parameters.</p>
    </div>

  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Giovanni Santacatterina.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

    </footer></div>





  </body></html>

