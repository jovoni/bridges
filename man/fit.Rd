% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/fit.R
\name{fit}
\alias{fit}
\title{Main Function for Genomic Distance Calculation and Phylogenetic Tree Construction}
\usage{
fit(
  data,
  chromosomes = c(1:22, "X", "Y"),
  alleles = c("CN", "A", "B"),
  k_jitter_fix = 0,
  bfb_penalty = 0,
  tree_func = ape::nj,
  fillna = 0,
  g_dist_func = "G_with_steps",
  b_dist_func = "A_contig",
  avoid_reconstruction = FALSE,
  ...
)
}
\arguments{
\item{data}{Input data containing genomic information. Should be in a format
that can be processed by \code{process_input_data()}.}

\item{chromosomes}{Vector of chromosomes to include in analysis (default: 1:22, "X", "Y").}

\item{alleles}{Alleles to consider (default: c(A", "B"), alternative: "CN").}

\item{k_jitter_fix}{Jitter factor for numerical stability (default: 0).}

\item{bfb_penalty}{Penalty for breakage-fusion-bridge events (default: 0).}

\item{tree_func}{Function to use for tree construction (default: ape::nj).}

\item{fillna}{Value to fill NA entries (default: 0).}

\item{g_dist_func}{Distance function to use for greedy calculation. Must be one
of the available G functions (default: "G_with_steps").}

\item{b_dist_func}{Distance function to use for BFB calculation. Must be one
of the available B functions (default: "A_contig").}

\item{...}{Additional arguments passed to downstream functions.}
}
\value{
A list containing:
\itemize{
\item tree - The constructed phylogenetic tree
\item all_input_Xs - Processed input data
\item D - Final distance matrix
\item greedy_Ds - Greedy distance matrices
\item avg_Ds - Balanced distance matrices
\item g_dist_func - Name of the used G distance function
\item b_dist_func - Name of the used B distance function
}
}
\description{
This is the enhanced main function that computes genomic distances between samples
with flexible distance function selection, processes the data, and constructs
a phylogenetic tree. It supports different distance metrics for greedy (G) and
BFB (B) distance calculations.
}
\details{
The function performs the following steps:
\enumerate{
\item Validates the selected distance functions
\item Processes input data
\item Computes distances using selected functions
\item Merges distance matrices
\item Optionally sums across minor alleles
\item Constructs phylogenetic tree
}

Available distance functions can be checked via \code{names(G_DISTS)} and \code{names(B_DISTS)}.
}
