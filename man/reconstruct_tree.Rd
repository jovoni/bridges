% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/bfb_mapping_and_detection.R
\name{reconstruct_tree}
\alias{reconstruct_tree}
\title{Reconstruct Phylogenetic Tree with Copy Number Analysis}
\usage{
reconstruct_tree(fit, chr, allele, store_profiles = TRUE)
}
\arguments{
\item{fit}{A fitted model object containing:
\itemize{
\item all_input_Xs: List of input data matrices by chromosome and allele
\item b_dist_func: B distance function for breakpoint-aware reconstruction
\item g_dist_func: G distance function for general reconstruction
\item tree: Phylogenetic tree structure (ape format)
}}

\item{chr}{Character string specifying the chromosome to analyze}

\item{allele}{Character string specifying the allele type ("CN" for copy number, others for allelic)}
}
\value{
A list containing:
\itemize{
\item internal_nodes: List of reconstructed internal node profiles
\item deltas: List of delta values (G cost - B cost) for each internal node
\item merged_profiles: List of merged profiles when B distance is chosen
\item final_input: Final working input matrix after all reconstructions
\item processed_nodes: Number of internal nodes processed
\item chr: Chromosome identifier
\item allele: Allele type
}
}
\description{
This function reconstructs a phylogenetic tree by traversing internal nodes and
computing distances between cell profiles. For each internal node, it calculates
both B distance (breakpoint-aware) and G distance (general) between child nodes,
then selects the reconstruction method that minimizes cost.
}
\details{
The function:
\enumerate{
\item Sets target values based on allele type (2 for "CN", 1 for others)
\item Processes internal nodes in post-order traversal
\item For each internal node, computes B and G distances between children
\item Calculates delta = G_cost - B_cost
\item Chooses B reconstruction if delta > 0, otherwise G reconstruction
\item Creates pseudo-cells for internal nodes and updates working dataset
}
}
\note{
The tree edge lengths are set to 1 for uniform weighting. Node labels
are automatically generated if not present.
}
